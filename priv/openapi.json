{
  "openapi" : "3.0.0",
  "info" : {
    "description" : "API for estimating trade margins for orders",
    "title" : "Margin API",
    "version" : "1.0.0"
  },
  "servers" : [ {
    "description" : "Default server",
    "url" : "/api/v2.0"
  } ],
  "tags" : [ {
    "description" : "Account operations for margin calculations",
    "name" : "preorder"
  } ],
  "paths" : {
    "/preorder/{account_id}" : {
      "get" : {
        "operationId" : "preorder_check_get",
        "parameters" : [ {
          "description" : "Account Id",
          "example" : "FBB1234.001",
          "explode" : false,
          "in" : "path",
          "name" : "account_id",
          "required" : true,
          "schema" : {
            "default" : "FBB1234.001",
            "type" : "string"
          },
          "style" : "simple"
        }, {
          "example" : "EUR/USD.EXANTE",
          "explode" : true,
          "in" : "query",
          "name" : "symbolId",
          "required" : true,
          "schema" : {
            "type" : "string"
          },
          "style" : "form"
        }, {
          "example" : "35.68",
          "explode" : true,
          "in" : "query",
          "name" : "quantity",
          "required" : true,
          "schema" : {
            "format" : "double",
            "type" : "number"
          },
          "style" : "form"
        }, {
          "description" : "Currency code",
          "explode" : true,
          "in" : "query",
          "name" : "currency",
          "required" : false,
          "schema" : {
            "default" : "EUR",
            "type" : "string"
          },
          "style" : "form"
        }, {
          "example" : "99.71",
          "explode" : true,
          "in" : "query",
          "name" : "price",
          "required" : false,
          "schema" : {
            "format" : "double",
            "type" : "number"
          },
          "style" : "form"
        }, {
          "explode" : true,
          "in" : "query",
          "name" : "showMarginStructure",
          "required" : false,
          "schema" : {
            "default" : false,
            "type" : "boolean"
          },
          "style" : "form"
        } ],
        "responses" : {
          "200" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/PreorderCheckResponse"
                }
              }
            },
            "description" : "Successful margin check operation"
          },
          "400" : {
            "description" : "Invalid input parameters"
          },
          "404" : {
            "description" : "Account not found"
          }
        },
        "summary" : "Estimate trade margin for one order",
        "tags" : [ "preorder" ]
      },
      "post" : {
        "operationId" : "preorder_check_post",
        "parameters" : [ {
          "description" : "Account Id",
          "example" : "FBB1234.001",
          "explode" : false,
          "in" : "path",
          "name" : "account_id",
          "required" : true,
          "schema" : {
            "default" : "FBB1234.001",
            "type" : "string"
          },
          "style" : "simple"
        } ],
        "requestBody" : {
          "content" : {
            "application/json" : {
              "schema" : {
                "$ref" : "#/components/schemas/preorder_check_post_request"
              }
            }
          },
          "required" : true
        },
        "responses" : {
          "200" : {
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/PreorderCheckResponse"
                }
              }
            },
            "description" : "Successful margin check operation for multiple orders"
          },
          "400" : {
            "description" : "Invalid input parameters"
          },
          "404" : {
            "description" : "Account not found"
          }
        },
        "summary" : "Estimate trade margin for list of orders",
        "tags" : [ "preorder" ]
      }
    }
  },
  "components" : {
    "schemas" : {
      "MarginStructureComponent" : {
        "example" : {
          "margin" : 4.145608029883936,
          "convExtremeMargin" : 1.0246457001441578,
          "leverageRate" : 2.027123023002322,
          "price" : 9.301444243932576,
          "convMargin" : 7.386281948385884,
          "crossrate" : 3.616076749251911,
          "extremeMargin" : 1.2315135367772556,
          "currency" : "currency",
          "position" : 7.061401241503109,
          "asset" : "asset",
          "effectiveQtty" : 1.4894159098541704,
          "assetType" : "regular"
        },
        "properties" : {
          "asset" : {
            "description" : "Asset identifier",
            "type" : "string"
          },
          "assetType" : {
            "enum" : [ "regular", "order_short", "order_long" ],
            "type" : "string"
          },
          "position" : {
            "format" : "double",
            "type" : "number"
          },
          "price" : {
            "format" : "double",
            "type" : "number"
          },
          "currency" : {
            "type" : "string"
          },
          "crossrate" : {
            "format" : "double",
            "type" : "number"
          },
          "leverageRate" : {
            "format" : "double",
            "type" : "number"
          },
          "margin" : {
            "format" : "double",
            "type" : "number"
          },
          "convMargin" : {
            "format" : "double",
            "type" : "number"
          },
          "extremeMargin" : {
            "format" : "double",
            "type" : "number"
          },
          "convExtremeMargin" : {
            "format" : "double",
            "type" : "number"
          },
          "effectiveQtty" : {
            "format" : "double",
            "type" : "number"
          }
        },
        "type" : "object"
      },
      "MarginStructure" : {
        "example" : {
          "before" : [ {
            "margin" : 4.145608029883936,
            "convExtremeMargin" : 1.0246457001441578,
            "leverageRate" : 2.027123023002322,
            "price" : 9.301444243932576,
            "convMargin" : 7.386281948385884,
            "crossrate" : 3.616076749251911,
            "extremeMargin" : 1.2315135367772556,
            "currency" : "currency",
            "position" : 7.061401241503109,
            "asset" : "asset",
            "effectiveQtty" : 1.4894159098541704,
            "assetType" : "regular"
          }, {
            "margin" : 4.145608029883936,
            "convExtremeMargin" : 1.0246457001441578,
            "leverageRate" : 2.027123023002322,
            "price" : 9.301444243932576,
            "convMargin" : 7.386281948385884,
            "crossrate" : 3.616076749251911,
            "extremeMargin" : 1.2315135367772556,
            "currency" : "currency",
            "position" : 7.061401241503109,
            "asset" : "asset",
            "effectiveQtty" : 1.4894159098541704,
            "assetType" : "regular"
          } ],
          "after" : [ {
            "margin" : 4.145608029883936,
            "convExtremeMargin" : 1.0246457001441578,
            "leverageRate" : 2.027123023002322,
            "price" : 9.301444243932576,
            "convMargin" : 7.386281948385884,
            "crossrate" : 3.616076749251911,
            "extremeMargin" : 1.2315135367772556,
            "currency" : "currency",
            "position" : 7.061401241503109,
            "asset" : "asset",
            "effectiveQtty" : 1.4894159098541704,
            "assetType" : "regular"
          }, {
            "margin" : 4.145608029883936,
            "convExtremeMargin" : 1.0246457001441578,
            "leverageRate" : 2.027123023002322,
            "price" : 9.301444243932576,
            "convMargin" : 7.386281948385884,
            "crossrate" : 3.616076749251911,
            "extremeMargin" : 1.2315135367772556,
            "currency" : "currency",
            "position" : 7.061401241503109,
            "asset" : "asset",
            "effectiveQtty" : 1.4894159098541704,
            "assetType" : "regular"
          } ]
        },
        "properties" : {
          "before" : {
            "items" : {
              "$ref" : "#/components/schemas/MarginStructureComponent"
            },
            "type" : "array"
          },
          "after" : {
            "items" : {
              "$ref" : "#/components/schemas/MarginStructureComponent"
            },
            "type" : "array"
          }
        },
        "type" : "object"
      },
      "PreorderCheckResponse" : {
        "example" : {
          "expectedCommission" : 5.637376656633329,
          "margin" : 0.8008281904610115,
          "newOrdersCommission" : 2.3021358869347655,
          "marginStructure" : {
            "before" : [ {
              "margin" : 4.145608029883936,
              "convExtremeMargin" : 1.0246457001441578,
              "leverageRate" : 2.027123023002322,
              "price" : 9.301444243932576,
              "convMargin" : 7.386281948385884,
              "crossrate" : 3.616076749251911,
              "extremeMargin" : 1.2315135367772556,
              "currency" : "currency",
              "position" : 7.061401241503109,
              "asset" : "asset",
              "effectiveQtty" : 1.4894159098541704,
              "assetType" : "regular"
            }, {
              "margin" : 4.145608029883936,
              "convExtremeMargin" : 1.0246457001441578,
              "leverageRate" : 2.027123023002322,
              "price" : 9.301444243932576,
              "convMargin" : 7.386281948385884,
              "crossrate" : 3.616076749251911,
              "extremeMargin" : 1.2315135367772556,
              "currency" : "currency",
              "position" : 7.061401241503109,
              "asset" : "asset",
              "effectiveQtty" : 1.4894159098541704,
              "assetType" : "regular"
            } ],
            "after" : [ {
              "margin" : 4.145608029883936,
              "convExtremeMargin" : 1.0246457001441578,
              "leverageRate" : 2.027123023002322,
              "price" : 9.301444243932576,
              "convMargin" : 7.386281948385884,
              "crossrate" : 3.616076749251911,
              "extremeMargin" : 1.2315135367772556,
              "currency" : "currency",
              "position" : 7.061401241503109,
              "asset" : "asset",
              "effectiveQtty" : 1.4894159098541704,
              "assetType" : "regular"
            }, {
              "margin" : 4.145608029883936,
              "convExtremeMargin" : 1.0246457001441578,
              "leverageRate" : 2.027123023002322,
              "price" : 9.301444243932576,
              "convMargin" : 7.386281948385884,
              "crossrate" : 3.616076749251911,
              "extremeMargin" : 1.2315135367772556,
              "currency" : "currency",
              "position" : 7.061401241503109,
              "asset" : "asset",
              "effectiveQtty" : 1.4894159098541704,
              "assetType" : "regular"
            } ]
          },
          "commissionChargeAccountId" : "commissionChargeAccountId",
          "marginCheckPassed" : true,
          "warnings" : [ "warnings", "warnings" ],
          "delta" : 5.962133916683182,
          "totalFreeMoney" : 1.4658129805029452,
          "freeMoney" : 6.027456183070403
        },
        "properties" : {
          "margin" : {
            "description" : "Required margin for the orders",
            "format" : "double",
            "type" : "number"
          },
          "freeMoney" : {
            "description" : "Available free money",
            "format" : "double",
            "type" : "number"
          },
          "totalFreeMoney" : {
            "description" : "Total available free money",
            "format" : "double",
            "type" : "number"
          },
          "delta" : {
            "description" : "Margin change",
            "format" : "double",
            "type" : "number"
          },
          "commissionChargeAccountId" : {
            "description" : "Account ID for commission charges",
            "type" : "string"
          },
          "expectedCommission" : {
            "description" : "Expected commission for the orders",
            "format" : "double",
            "type" : "number"
          },
          "newOrdersCommission" : {
            "description" : "Commission for new orders",
            "format" : "double",
            "type" : "number"
          },
          "marginCheckPassed" : {
            "description" : "Whether the margin check passed",
            "type" : "boolean"
          },
          "marginStructure" : {
            "$ref" : "#/components/schemas/MarginStructure"
          },
          "warnings" : {
            "description" : "List of warnings if any",
            "items" : {
              "type" : "string"
            },
            "type" : "array"
          }
        },
        "type" : "object"
      },
      "preorder_check_post_request_ordersData_inner" : {
        "properties" : {
          "price" : {
            "example" : 45.31,
            "format" : "double",
            "type" : "number"
          },
          "quantity" : {
            "example" : 89.25,
            "format" : "double",
            "type" : "number"
          },
          "symbolId" : {
            "example" : "EUR/USD.EXANTE",
            "type" : "string"
          }
        },
        "required" : [ "quantity", "symbolId" ],
        "type" : "object"
      },
      "preorder_check_post_request" : {
        "properties" : {
          "currency" : {
            "default" : "EUR",
            "description" : "Currency code",
            "type" : "string"
          },
          "ordersData" : {
            "items" : {
              "$ref" : "#/components/schemas/preorder_check_post_request_ordersData_inner"
            },
            "type" : "array"
          },
          "showMarginStructure" : {
            "default" : false,
            "type" : "boolean"
          }
        },
        "required" : [ "ordersData" ],
        "type" : "object"
      }
    },
    "securitySchemes" : { }
  }
}
